<?php
//====================================================================
//====================================================================
//====================================================================
//!
//! @file    img.php
//! @brief   イメージ出力制御
//! @author  木屋 善夫
//! @date    2012-12-27
//! @version $Revision: $
//!
//! Copyright (C) 2012 Yoshio Kiya  All rights reserved.
//!
//====================================================================
//====================================================================
//====================================================================

//=== インクルード ===================================================
require_once( '../libkya/KyaApp.php' );

//====================================================================
//! main関数
//====================================================================
class CImgApp extends CKyaAppHttp
{
	//================================================================
	/**
	 * 構築
	 * @access    public
	*/
	//================================================================
	public function __construct( )
	{
		//=== デフォルトインプリメンテーションの呼び出し =============
		parent::__construct( );
	}

	//================================================================
	/**
	 * 消滅
	 * @access    public
	*/
	//================================================================
	public function __destruct( )
	{
		//=== デフォルトインプリメンテーションの呼び出し =============
		parent::__destruct( );
	}

	//================================================================
	// アトリビュート(定数)
	//================================================================

	//================================================================
	// アトリビュート(変数)
	//================================================================

	//================================================================
	/**
	 * 初期化
	 * @access    public
	 * @retval    FALSE エラー
	*/
	//================================================================
	public function blInit( )
	{
		//=== DB 使用宣言 ============================================
//		$a = explode( '.', $_SERVER['HTTP_HOST'] );
//		$strDB = str_replace( '-', '_', $a[0] );
//		mixSetConfig( 'USE_DB'   , TRUE );
//		mixSetConfig( 'DB_SERVER', 'localhost' );
//		mixSetConfig( 'DB_USER'  , 'ds10' );
//		mixSetConfig( 'DB_PASS'  , 'ds10' );
//		mixSetConfig( 'DB_NAME'  , $strDB );

		//=== デフォルトインプリメンテーションの呼び出し =============
		if ( !parent::blInit( ) )
			return FALSE;

		//============================================================
		return TRUE;
	}

	//================================================================
	/**
	 * 処理
	 * @access    public
 	*/
	//================================================================
	public function Run( )
	{
		$strFile = $_REQUEST['src'];
		$strExt  = $_REQUEST['ext'];

		header( "Content-Type: Content-type: image/{$strExt}" );
		readfile( "../material/{$strFile}" );
	}
}

//====================================================================
new CImgApp( );
objGetApp( )->Exec( );
?>