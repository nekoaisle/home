<?php
//====================================================================
//====================================================================
//====================================================================
//!
//! @file    tab.php
//! @brief   タブページ
//! @author  木屋 善夫
//! @date    2014-03-13
//! @version $Revision: $
//!
//! Copyright (C) 2014 Yoshio Kiya  All rights reserved.
//!
//====================================================================
//====================================================================
//====================================================================
require_once( './config.php' );

//====================================================================
// コントローラー
//====================================================================
class CTabCtrl extends CKyaCtrlHttp
{
	//================================================================
	/**
	 * 構築
	 * @access    public
	*/
	//================================================================
	public function __construct( )
	{
		parent::__construct( );

//		mixSetConfig( 'NEED_LOGIN', 1 );
	}

	//================================================================
	/**
	 * 消滅
	 * @access    public
	*/
	//================================================================
	public function __destruct( )
	{
		parent::__destruct( );
	}

	//================================================================
	// アトリビュート(定数)
	//================================================================

	//================================================================
	// アトリビュート(変数)
	//================================================================

	//================================================================
	/**
	 * 初期化
	 * @access    public
	 * @retval    FALSE エラー
	*/
	//================================================================
	public function blInit( )
	{
		//=== デフォルトインプリメンテーションの呼び出し =============
		if ( !parent::blInit( ) )
			return FALSE;

		//============================================================
		$objApp = objGetApp( );
		$objApp->m_strProgress = '';

		//=== コマンドを追加 =========================================
//		$this->RegistCommand( 'SUM'   );

		//============================================================
		return TRUE;
	}

	//================================================================
	/**
	 * 通常の処理
	 * @access    public
 	*/
	//================================================================
	public function Run( )
	{
		//=== デフォルトインプリメンテーションの呼び出し =============
		parent::Run( );

		//============================================================
//		$objDB  = objGetDB( );
		$objApp = objGetApp( );
		$objDoc = objGetDoc( );

		//============================================================
		if ( $objApp->m_iLoginLevel <= 0 )
			$strUser = 'default';
		else
			$strUser = $objApp->m_rowUser['V_EMAIL'];

		$aryConfig = aryGetConfig( $strUser );

		//============================================================
		$iTab = iGetRequest( 't', 0 );
		$objDoc->m_strTabNo = (string)$iTab;
		for ( $iCol = 0; $iCol < 3; ++ $iCol )
		{
			if ( !empty( $aryConfig['tabs'][$iTab]['cols'][$iCol] ) )
			{
				$var = "m_aryCol{$iCol}";
				$objDoc->$var = $aryConfig['tabs'][$iTab]['cols'][$iCol]['parts'];
			}
		}
	}
}

//====================================================================
// ドキュメント
//====================================================================
class CTabDoc extends CKyaDocHttp
{
	//================================================================
	/**
	 * 構築
	 * @access    public
	*/
	//================================================================
	public function __construct( )
	{
		parent::__construct( );

		//=== タイトルの設定 =========================================
		mixSetConfig( 'PAGE_TITLE', 'トップページ' );
	}

	//================================================================
	/**
	 * 消滅
	 * @access    public
	*/
	//================================================================
	public function __destruct( )
	{
		parent::__destruct( );
	}

	//================================================================
	// アトリビュート(定数)
	//================================================================

	//================================================================
	// アトリビュート(変数)
	//================================================================
	public $m_aryCol0 = array( );
	public $m_aryCol1 = array( );
	public $m_aryCol2 = array( );

	//================================================================
	/**
	 * 初期化
	 * @access    public
	 * @retval    FALSE エラー
	*/
	//================================================================
	public function blInit( )
	{
		//=== デフォルトインプリメンテーションの呼び出し =============
		if ( !parent::blInit( ) )
			return FALSE;

		//============================================================
		return TRUE;
	}

	//================================================================
	/**
	 * 処理
	 * @access    public
 	*/
	//================================================================
	public function Run( )
	{
		//=== デフォルトインプリメンテーションの呼び出し =============
		parent::Run( );
	}

}

//====================================================================
// ヴュー
//====================================================================
class CTabView extends CKyaViewHttp
{
	//================================================================
	/**
	 * 構築
	 * @access    public
	*/
	//================================================================
	public function __construct( )
	{
		//=== デフォルトインプリメンテーションの呼び出し =============
		parent::__construct( );
	}

	//================================================================
	/**
	 * 消滅
	 * @access    public
	*/
	//================================================================
	public function __destruct( )
	{
		parent::__destruct( );
	}

	//================================================================
	// アトリビュート(定数)
	//================================================================

	//================================================================
	// アトリビュート(変数)
	//================================================================

	//================================================================
	/**
	 * 初期化
	 * @access    public
	 * @retval    FALSE エラー
	*/
	//================================================================
	public function blInit( )
	{
		//=== デフォルトインプリメンテーションの呼び出し =============
		if ( !parent::blInit( ) )
			return FALSE;

		//=== HTML ファイル名の設定 ==================================
		// フレームを使用しない
//		$strDir  = dirname( realpath( $_SERVER['SCRIPT_FILENAME'] ) );
//		mixSetConfig( 'FRAME_HTML', "" );

//		$strName = objGetApp()->m_strTask;
//		mixSetConfig( 'HTML_FILE' , "{$strDir}/{$strName}.html" );

		//============================================================
		return TRUE;
	}

	//================================================================
	/**
	 * 処理
	 * @access    public
 	*/
	//================================================================
	public function Run( )
	{
		//=== デフォルトインプリメンテーションの呼び出し =============
		parent::Run( );
	}
}

?>