<?php
//====================================================================
//====================================================================
//====================================================================
//!
//! @file    tab.php
//! @brief   タブページ
//! @author  木屋 善夫
//! @date    2014-03-13
//! @version $Revision: $
//!
//! Copyright (C) 2014 Yoshio Kiya  All rights reserved.
//!
//====================================================================
//====================================================================
//====================================================================
require_once( dirname(__FILE__) . '/../libkya/KyaApp.php' );
require_once( dirname(__FILE__) . '/config.php' );

//====================================================================
// コントローラー
//====================================================================
class CTabApp extends CKyaAppHttp
{
	//================================================================
	/**
	 * 構築
	 * @access    public
	*/
	//================================================================
	public function __construct( )
	{
		parent::__construct( );
	}

	//================================================================
	/**
	 * 消滅
	 * @access    public
	*/
	//================================================================
	public function __destruct( )
	{
		parent::__destruct( );
	}

	//================================================================
	// アトリビュート(定数)
	//================================================================

	//================================================================
	// アトリビュート(変数)
	//================================================================

	//================================================================
	/**
	 * 初期化
	 * @access    public
	 * @retval    FALSE エラー
	*/
	//================================================================
	public function blInit( )
	{
		//=== デフォルトインプリメンテーションの呼び出し =============
		if ( !parent::blInit( ) )
			return FALSE;

		//============================================================
		return TRUE;
	}

	//================================================================
	/**
	 * 通常の処理
	 * @access    public
 	*/
	//================================================================
	public function Run( )
	{
		//=== デフォルトインプリメンテーションの呼び出し =============
		parent::Run( );

		//============================================================
		$objApp = objGetApp( );

		//============================================================
		$this->m_strUser = 'default';
		if ( !empty( $_SESSION['CIndex.m_iLoginLevel'] ) )
			$this->m_strUser = $_SESSION['CIndex.m_rowUser']['V_EMAIL'];

		$aryConfig = aryGetConfig( $this->m_strUser );

		//============================================================
		$iTab = iGetRequest( 't', 0 );
		$this->m_iTabNo = $iTab;

		$this->m_aryCols = array( );
		foreach ( $aryConfig['tabs'][$iTab]['cols'] as $iCol => $aryRows )
			$this->m_aryCols[$iCol] = $aryRows['parts'];
	}
}

//====================================================================
new CTabApp( );
objGetApp( )->Exec( );
require_once( dirname(__FILE__) . '/tab.phtml' );
?>